<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8">
    <title>{% block title %}後台控制台{% endblock %} | EnnovicX</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <link rel="stylesheet" href="/assets/tabler/css/tabler.min.css?1745207578" />
	
    <link
      href="/assets/tabler/css/tabler-flags.min.css?1745207578"
      rel="stylesheet" />
    
    <link
      href="/assets/tabler/css/tabler-socials.min.css?1745207578"
      rel="stylesheet" />
    
    <link
      href="/assets/tabler/css/tabler-payments.min.css?1745207578"
      rel="stylesheet" />
    
    <link
      href="/assets/tabler/css/tabler-vendors.min.css?1745207578"
      rel="stylesheet" />
    
    <link
      href="/assets/tabler/css/tabler-marketing.min.css?1745207578"
      rel="stylesheet" />
    
    <link
      href="/assets/tabler/css/tabler-themes.min.css?1745207578"
      rel="stylesheet" />
    {% block styles %}{% endblock %}
  </head>
  <body>
    <script src="/assets/tabler/js/tabler-theme.min.js"></script>
    <div class="page">
      <!-- Sidebar -->
      <aside class="navbar navbar-vertical navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
          <a href="/opanel/dashboard" class="navbar-brand">
            <strong>EnnovicX</strong>
          </a>
          <div class="collapse navbar-collapse" id="sidebar-menu">
            <ul class="navbar-nav pt-lg-3">
              <li class="nav-item">
                <a class="nav-link" href="/opanel/dashboard">
                  <span class="nav-link-icon"><i class="ti ti-layout-dashboard"></i></span>
                  <span class="nav-link-title">控制台</span>
                </a>
              </li>
              
              <!-- 權限管理菜單組 -->
              <li class="nav-item">
                <a class="nav-link dropdown-toggle" href="#navbar-access" data-bs-toggle="dropdown" data-bs-auto-close="outside" role="button" aria-expanded="false">
                  <span class="nav-link-icon d-md-none d-lg-inline-block">
                    <i class="ti ti-shield-lock"></i>
                  </span>
                  <span class="nav-link-title">權限管理</span>
                </a>
                <div class="dropdown-menu">
                  <a class="dropdown-item" href="/opanel/access/refine-names">
                    <span class="dropdown-item-icon">
                      <i class="ti ti-wand"></i>
                    </span>
                    <span class="dropdown-item-text">更新權限名稱</span>
                  </a>
                  <a class="dropdown-item" href="/opanel/access/roles">
                    <span class="dropdown-item-icon">
                      <i class="ti ti-users-group"></i>
                    </span>
                    <span class="dropdown-item-text">角色權限設定</span>
                  </a>
                  <a class="dropdown-item" href="/opanel/access/permissions">
                    <span class="dropdown-item-icon">
                      <i class="ti ti-checklist"></i>
                    </span>
                    <span class="dropdown-item-text">功能權限管理</span>
                  </a>
                </div>
              </li>
              <!-- 可擴充項目 -->
            </ul>
          </div>
        </div>
      </aside>

      <!-- Main wrapper -->
      <div class="page-wrapper">
        <!-- Navbar -->
        <header class="navbar navbar-expand-md d-print-none">
          <div class="container-xl">
            <div class="navbar-brand d-md-none">
              <a href="#">EnnovicX</a>
            </div>
            <div class="navbar-nav flex-row order-md-last">
              <div class="nav-item dropdown">
                <a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown">
                  <span class="avatar avatar-sm" style="background-image: url(/assets/img/avatar.png)"></span>
                  <div class="d-none d-xl-block ps-2">
                    <div>{{ current_user.display_name|default('Admin') }}</div>
                  </div>
                </a>
                <div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                  <a class="dropdown-item" href="#">設定</a>
                  <a class="dropdown-item" href="/opanel/logout">登出</a>
                </div>
              </div>
            </div>
          </div>
        </header>

        <!-- Page content -->
        <main class="page-body">
          <div class="container-xl">
            <!-- Flash 訊息顯示區域 -->
            {% if flash.getMessages() %}
              <div class="mt-3">
                {% for type, messages in flash.getMessages() %}
                  {% for message in messages %}
                    <div class="alert alert-{{ type }} alert-dismissible" role="alert">
                      {{ message }}
                      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="關閉"></button>
                    </div>
                  {% endfor %}
                {% endfor %}
              </div>
            {% endif %}
            
            {% block content %}{% endblock %}
          </div>
        </main>

        <!-- Footer -->
        <footer class="footer footer-transparent d-print-none">
          <div class="container-xl text-center">
            <span class="text-muted">© 2025 EnnovicX</span>
          </div>
        </footer>
      </div>
    </div>
    <!-- Toast Container：放在 layout.twig 的 </body> 前 -->
    <div id="toast-container" class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 1055;"></div>

    {% block scripts %}{% endblock %}
    <script src="/js/toast.js"></script>
    <script src="/assets/tabler/js/tabler.min.js" defer></script>
    
  </body>
</html>
