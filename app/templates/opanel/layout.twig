<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8">
    <title>{% block title %}後台控制台{% endblock %} | EnnovicX</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <link rel="stylesheet" href="/assets/tabler/css/tabler.min.css?1745207578" />
	
    <link
      href="/assets/tabler/css/tabler-flags.min.css?1745207578"
      rel="stylesheet" />
    
    <link
      href="/assets/tabler/css/tabler-socials.min.css?1745207578"
      rel="stylesheet" />
    
    <link
      href="/assets/tabler/css/tabler-payments.min.css?1745207578"
      rel="stylesheet" />
    
    <link
      href="/assets/tabler/css/tabler-vendors.min.css?1745207578"
      rel="stylesheet" />
    
    <link
      href="/assets/tabler/css/tabler-marketing.min.css?1745207578"
      rel="stylesheet" />
    
    <link
      href="/assets/tabler/css/tabler-themes.min.css?1745207578"
      rel="stylesheet" />
    {% block styles %}{% endblock %}
  </head>
  <body>
    <script src="/assets/tabler/js/tabler-theme.min.js"></script>
    <div class="page">
      <!-- Sidebar -->
      <aside class="navbar navbar-vertical navbar-expand-lg" data-bs-theme="dark">
        <div class="container-fluid">
          <!-- 小螢幕切換按鈕 -->
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#sidebar-menu"
            aria-controls="sidebar-menu"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          
          <!-- Logo -->
          <div class="navbar-brand navbar-brand-autodark">
            <a href="/opanel/dashboard" class="text-decoration-none">
              <strong>EnnovicX</strong>
            </a>
          </div>
          
          <!-- 小螢幕頂部小圖示 -->
          <div class="navbar-nav flex-row d-lg-none">
            <div class="nav-item dropdown">
              <a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown" aria-label="Open user menu">
                <span class="avatar avatar-sm" style="background-image: url(/assets/img/avatar.png)"></span>
              </a>
              <div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                <a class="dropdown-item" href="#">設定</a>
                <a class="dropdown-item" href="/opanel/logout">登出</a>
              </div>
            </div>
          </div>
          
          <!-- 主要側邊欄選單 -->
          <div class="collapse navbar-collapse" id="sidebar-menu">
            <ul class="navbar-nav pt-lg-3">
              <li class="nav-item">
                <a class="nav-link" href="/opanel/dashboard">
                  <span class="nav-link-icon">
                    <!-- 使用 SVG 圖示 -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                      <path d="M4 4h6v8h-6z" />
                      <path d="M14 4h6v8h-6z" />
                      <path d="M4 16h6v4h-6z" />
                      <path d="M14 16h6v4h-6z" />
                    </svg>
                  </span>
                  <span class="nav-link-title">控制台</span>
                </a>
              </li>
              
              <!-- 權限管理菜單組 -->
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#navbar-access" data-bs-toggle="dropdown" data-bs-auto-close="outside" role="button" aria-expanded="false">
                  <span class="nav-link-icon">
                    <!-- 使用 SVG 圖示 -->
                    <svg class="icon" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.5 11.5 11 13l4-3.5M12 20a16.405 16.405 0 0 1-5.092-5.804A16.694 16.694 0 0 1 5 6.666L12 4l7 2.667a16.695 16.695 0 0 1-1.908 7.529A16.406 16.406 0 0 1 12 20Z"/>
                    </svg>
                    
                  </span>
                  <span class="nav-link-title">權限管理</span>
                </a>
                <div class="dropdown-menu">
                  <a class="dropdown-item" href="/opanel/access/refine-names">
                    <span class="dropdown-item-icon">
                      <i class="ti ti-wand"></i>
                    </span>
                    <span class="dropdown-item-text">更新權限名稱</span>
                  </a>
                  <a class="dropdown-item" href="/opanel/access/roles">
                    <span class="dropdown-item-icon">
                      <i class="ti ti-users-group"></i>
                    </span>
                    <span class="dropdown-item-text">角色權限設定</span>
                  </a>
                  {# <a class="dropdown-item" href="/opanel/access/permissions">
                    <span class="dropdown-item-icon">
                      <i class="ti ti-checklist"></i>
                    </span>
                    <span class="dropdown-item-text">功能權限管理</span>
                  </a> #}
                </div>
              </li>
              <!-- 可擴充項目 -->
            </ul>
          </div>
        </div>
      </aside>

      <!-- Main wrapper -->
      <div class="page-wrapper">
        <!-- Navbar -->
        <header class="navbar navbar-expand-md d-print-none">
          <div class="container-xl">
            <div class="navbar-brand d-md-none">
              <a href="#">EnnovicX</a>
            </div>
            <div class="navbar-nav flex-row order-md-last">
              <div class="nav-item dropdown">
                <a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown">
                  <span class="avatar avatar-sm" style="background-image: url(/assets/img/avatar.png)"></span>
                  <div class="d-none d-xl-block ps-2">
                    <div>{{ current_user.display_name|default('Admin') }}</div>
                  </div>
                </a>
                <div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                  <a class="dropdown-item" href="#">設定</a>
                  <a class="dropdown-item" href="/opanel/logout">登出</a>
                </div>
              </div>
            </div>
          </div>
        </header>

        <!-- Page content -->
        <main class="page-body">
          <div class="container-xl">
            <!-- Flash 訊息顯示區域 -->
            {% if flash.getMessages() %}
              <div class="mt-3">
                {% for type, messages in flash.getMessages() %}
                  {% for message in messages %}
                    <div class="alert alert-{{ type }} alert-dismissible" role="alert">
                      {{ message }}
                      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="關閉"></button>
                    </div>
                  {% endfor %}
                {% endfor %}
              </div>
            {% endif %}
            
            {% block content %}{% endblock %}
          </div>
        </main>

        <!-- Footer -->
        <footer class="footer footer-transparent d-print-none">
          <div class="container-xl text-center">
            <span class="text-muted">© 2025 EnnovicX</span>
          </div>
        </footer>
      </div>
    </div>
    <!-- Toast Container：放在 layout.twig 的 </body> 前 -->
    <div id="toast-container" class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 1055;"></div>

    {% block scripts %}{% endblock %}
    <script src="/js/toast.js"></script>
    <script src="/assets/tabler/js/tabler.min.js" defer></script>
    
  </body>
</html>
